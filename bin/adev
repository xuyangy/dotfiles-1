#!/bin/bash
set -eEuo pipefail

trap 'echo "{\"state\":\"Critical\", \"text\": \" failed setting sink\"}" && exit' ERR


setHeadphones() {
  output="alsa_output.usb-BEHRINGER_UMC204HD_192k-00"
  setSink
}

setMonitor() {
  output="alsa_output.pci-0000_00_1b.0"
  setSink
}

setSink() {
	sink=$(pactl list short sinks | rg -o -m1 "($output\..*?)\s" --replace "\$1")
	pactl set-default-sink $sink
}

if [ "$1" == "headphones" ]; then
	setHeadphones
	exit 0
fi

if [ "$1" == "monitor" ]; then
	setMonitor
	exit 0
fi

exit -1

pactl set-default-sink 
